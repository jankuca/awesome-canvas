function i(a){throw a;}var k=void 0,n=null,o,p=this;function q(){}
function r(a){var c=typeof a;if(c=="object")if(a){if(a instanceof Array)return"array";else if(a instanceof Object)return c;var b=Object.prototype.toString.call(a);if(b=="[object Window]")return"object";if(b=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(b=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if(c=="function"&&typeof a.call=="undefined")return"object";return c}function aa(a){var c=r(a);return c=="array"||c=="object"&&typeof a.length=="number"}function s(a){return typeof a=="string"}function ba(a){return r(a)=="function"}function ca(a){a=r(a);return a=="object"||a=="array"||a=="function"}var t="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36),da=0,ea=Date.now||function(){return+new Date};function v(a,c){x.prototype[a]=c}
function fa(a,c){function b(){}b.prototype=c.prototype;a.ka=c.prototype;a.prototype=new b};function ga(a){if(!ha.test(a))return a;a.indexOf("&")!=-1&&(a=a.replace(ia,"&amp;"));a.indexOf("<")!=-1&&(a=a.replace(ja,"&lt;"));a.indexOf(">")!=-1&&(a=a.replace(ka,"&gt;"));a.indexOf('"')!=-1&&(a=a.replace(la,"&quot;"));return a}var ia=/&/g,ja=/</g,ka=/>/g,la=/\"/g,ha=/[&<>\"]/;
function ma(a,c){for(var b=0,d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=String(c).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=Math.max(d.length,e.length),g=0;b==0&&g<f;g++){var h=d[g]||"",j=e[g]||"",l=RegExp("(\\d*)(\\D*)","g"),A=RegExp("(\\d*)(\\D*)","g");do{var m=l.exec(h)||["","",""],w=A.exec(j)||["","",""];if(m[0].length==0&&w[0].length==0)break;b=na(m[1].length==0?0:parseInt(m[1],10),w[1].length==0?0:parseInt(w[1],10))||na(m[2].length==0,w[2].length==0)||na(m[2],w[2])}while(b==
0)}return b}function na(a,c){if(a<c)return-1;else if(a>c)return 1;return 0}var oa={};function pa(a){return oa[a]||(oa[a]=String(a).replace(/([A-Z])/g,"-$1").toLowerCase())};var y=Array.prototype,z=y.indexOf?function(a,c,b){return y.indexOf.call(a,c,b)}:function(a,c,b){b=b==n?0:b<0?Math.max(0,a.length+b):b;if(s(a))return!s(c)||c.length!=1?-1:a.indexOf(c,b);for(;b<a.length;b++)if(b in a&&a[b]===c)return b;return-1},qa=y.forEach?function(a,c,b){y.forEach.call(a,c,b)}:function(a,c,b){for(var d=a.length,e=s(a)?a.split(""):a,f=0;f<d;f++)f in e&&c.call(b,e[f],f,a)};function ra(a){return y.concat.apply(y,arguments)}
function sa(a){if(r(a)=="array")return ra(a);else{for(var c=[],b=0,d=a.length;b<d;b++)c[b]=a[b];return c}}function ta(a,c,b,d){y.splice.apply(a,ua(arguments,1))}function ua(a,c,b){return arguments.length<=2?y.slice.call(a,c):y.slice.call(a,c,b)};var B,va,wa,xa;function ya(){return p.navigator?p.navigator.userAgent:n}xa=wa=va=B=!1;var za;if(za=ya()){var Aa=p.navigator;B=za.indexOf("Opera")==0;va=!B&&za.indexOf("MSIE")!=-1;wa=!B&&za.indexOf("WebKit")!=-1;xa=!B&&!wa&&Aa.product=="Gecko"}var C=va,Ba=xa,Ca=wa,Da=p.navigator,Ea=(Da&&Da.platform||"").indexOf("Mac")!=-1,Fa;
a:{var Ga="",D;if(B&&p.opera)var Ha=p.opera.version,Ga=typeof Ha=="function"?Ha():Ha;else if(Ba?D=/rv\:([^\);]+)(\)|;)/:C?D=/MSIE\s+([^\);]+)(\)|;)/:Ca&&(D=/WebKit\/(\S+)/),D)var Ia=D.exec(ya()),Ga=Ia?Ia[1]:"";if(C){var Ja,Ka=p.document;Ja=Ka?Ka.documentMode:k;if(Ja>parseFloat(Ga)){Fa=String(Ja);break a}}Fa=Ga}var La={};function E(a){return La[a]||(La[a]=ma(Fa,a)>=0)};var Ma=!C||E("9");!Ba&&!C||C&&E("9")||Ba&&E("1.9.1");C&&E("9");function Na(a){return(a=a.className)&&typeof a.split=="function"?a.split(/\s+/):[]}function F(a,c){var b=Na(a),d=ua(arguments,1),e;e=b;for(var f=0,g=0;g<d.length;g++)z(e,d[g])>=0||(e.push(d[g]),f++);e=f==d.length;a.className=b.join(" ");return e}function G(a,c){for(var b=Na(a),d=ua(arguments,1),e=b,f=0,g=0;g<e.length;g++)z(d,e[g])>=0&&(ta(e,g--,1),f++);a.className=b.join(" ")};function Oa(a,c){for(var b in a)c.call(k,a[b],b,a)}var Pa="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function Qa(a,c){for(var b,d,e=1;e<arguments.length;e++){d=arguments[e];for(b in d)a[b]=d[b];for(var f=0;f<Pa.length;f++)b=Pa[f],Object.prototype.hasOwnProperty.call(d,b)&&(a[b]=d[b])}};function Ra(a,c){Oa(c,function(b,c){c=="style"?a.style.cssText=b:c=="class"?a.className=b:c=="for"?a.htmlFor=b:c in Sa?a.setAttribute(Sa[c],b):a[c]=b})}var Sa={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};
function H(a,c,b){var d=arguments,e=document,f=d[0],g=d[1];if(!Ma&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',ga(g.name),'"');if(g.type){f.push(' type="',ga(g.type),'"');var h={};Qa(h,g);g=h;delete g.type}f.push(">");f=f.join("")}f=e.createElement(f);if(g)s(g)?f.className=g:r(g)=="array"?F.apply(n,[f].concat(g)):Ra(f,g);d.length>2&&Ta(e,f,d);return f}
function Ta(a,c,b){function d(b){b&&c.appendChild(s(b)?a.createTextNode(b):b)}for(var e=2;e<b.length;e++){var f=b[e];aa(f)&&!(ca(f)&&f.nodeType>0)?qa(Ua(f)?sa(f):f,d):d(f)}}function Va(a,c){a.insertBefore(c,a.childNodes[0]||n)}function Wa(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function Ua(a){if(a&&typeof a.length=="number")if(ca(a))return typeof a.item=="function"||typeof a.item=="string";else if(ba(a))return typeof a.item=="function";return!1};function I(a,c,b){a.dataset?a.dataset[c]=b:a.setAttribute("data-"+pa(c),b)}function J(a,c){return a.dataset?a.dataset[c]:a.getAttribute("data-"+pa(c))};var Xa;!C||E("9");var Ya=C&&!E("8");function K(){}K.prototype.Ba=!1;K.prototype.T=function(){if(!this.Ba)this.Ba=!0,this.C()};K.prototype.C=function(){};function L(a,c){this.type=a;this.currentTarget=this.target=c}fa(L,K);L.prototype.C=function(){delete this.type;delete this.target;delete this.currentTarget};L.prototype.ja=!1;L.prototype.Ma=!0;L.prototype.preventDefault=function(){this.Ma=!1};var Za=new Function("a","return a");function M(a,c){a&&this.w(a,c)}fa(M,L);o=M.prototype;o.target=n;o.relatedTarget=n;o.offsetX=0;o.offsetY=0;o.clientX=0;o.clientY=0;o.screenX=0;o.screenY=0;o.button=0;o.keyCode=0;o.charCode=0;o.ctrlKey=!1;o.altKey=!1;o.shiftKey=!1;o.metaKey=!1;o.ib=!1;o.ea=n;
o.w=function(a,c){var b=this.type=a.type;L.call(this,b);this.target=a.target||a.srcElement;this.currentTarget=c;var d=a.relatedTarget;if(d){if(Ba)try{Za(d.nodeName)}catch(e){d=n}}else if(b=="mouseover")d=a.fromElement;else if(b=="mouseout")d=a.toElement;this.relatedTarget=d;this.offsetX=a.offsetX!==k?a.offsetX:a.layerX;this.offsetY=a.offsetY!==k?a.offsetY:a.layerY;this.clientX=a.clientX!==k?a.clientX:a.pageX;this.clientY=a.clientY!==k?a.clientY:a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||
0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||(b=="keypress"?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.ib=Ea?a.metaKey:a.ctrlKey;this.state=a.state;this.ea=a;delete this.Ma;delete this.ja};o.preventDefault=function(){M.ka.preventDefault.call(this);var a=this.ea;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Ya)try{if(a.ctrlKey||a.keyCode>=112&&a.keyCode<=123)a.keyCode=-1}catch(c){}};
o.C=function(){M.ka.C.call(this);this.relatedTarget=this.currentTarget=this.target=this.ea=n};function $a(){}var ab=0;o=$a.prototype;o.key=0;o.G=!1;o.wa=!1;o.w=function(a,c,b,d,e,f){ba(a)?this.Ga=!0:a&&a.handleEvent&&ba(a.handleEvent)?this.Ga=!1:i(Error("Invalid listener argument"));this.U=a;this.La=c;this.src=b;this.type=d;this.capture=!!e;this.Fa=f;this.wa=!1;this.key=++ab;this.G=!1};o.handleEvent=function(a){return this.Ga?this.U.call(this.Fa||this.src,a):this.U.handleEvent.call(this.U,a)};function N(a,c){this.Ja=c;this.v=[];a>this.Ja&&i(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var b=0;b<a;b++)this.v.push(this.L())}fa(N,K);o=N.prototype;o.u=n;o.Aa=n;o.getObject=function(){return this.v.length?this.v.pop():this.L()};function O(a,c){a.v.length<a.Ja?a.v.push(c):a.ba(c)}o.L=function(){return this.u?this.u():{}};o.ba=function(a){if(this.Aa)this.Aa(a);else if(ca(a))if(ba(a.T))a.T();else for(var c in a)delete a[c]};
o.C=function(){N.ka.C.call(this);for(var a=this.v;a.length;)this.ba(a.pop());delete this.v};var bb,cb=(bb="ScriptEngine"in p&&p.ScriptEngine()=="JScript")?p.ScriptEngineMajorVersion()+"."+p.ScriptEngineMinorVersion()+"."+p.ScriptEngineBuildVersion():"0";var db,eb,P,fb,gb,hb,ib,jb,kb,lb,mb;
(function(){function a(){return{f:0,F:0}}function c(){return[]}function b(){function a(b){return g.call(a.src,a.key,b)}return a}function d(){return new $a}function e(){return new M}var f=bb&&!(ma(cb,"5.7")>=0),g;hb=function(a){g=a};if(f){db=function(){return h.getObject()};eb=function(a){O(h,a)};P=function(){return j.getObject()};fb=function(a){O(j,a)};gb=function(){return l.getObject()};ib=function(){O(l,b())};jb=function(){return A.getObject()};kb=function(a){O(A,a)};lb=function(){return m.getObject()};
mb=function(a){O(m,a)};var h=new N(0,600);h.u=a;var j=new N(0,600);j.u=c;var l=new N(0,600);l.u=b;var A=new N(0,600);A.u=d;var m=new N(0,600);m.u=e}else db=a,eb=q,P=c,fb=q,gb=b,ib=q,jb=d,kb=q,lb=e,mb=q})();var Q={},R={},S={},T={};
function U(a,c,b,d,e){if(c)if(r(c)=="array")for(var f=0;f<c.length;f++)U(a,c[f],b,d,e);else{var d=!!d,g=R;c in g||(g[c]=db());g=g[c];d in g||(g[d]=db(),g.f++);var g=g[d],h=a[t]||(a[t]=++da),j;g.F++;if(g[h]){j=g[h];for(f=0;f<j.length;f++)if(g=j[f],g.U==b&&g.Fa==e){if(g.G)break;return}}else j=g[h]=P(),g.f++;f=gb();f.src=a;g=jb();g.w(b,f,a,c,d,e);b=g.key;f.key=b;j.push(g);Q[b]=g;S[h]||(S[h]=P());S[h].push(g);a.addEventListener?(a==p||!a.$a)&&a.addEventListener(c,f,d):a.attachEvent(c in T?T[c]:T[c]="on"+
c,f)}else i(Error("Invalid event type"))}function nb(a,c,b,d){if(!d.V&&d.Ka){for(var e=0,f=0;e<d.length;e++)if(d[e].G){var g=d[e].La;g.src=n;ib(g);kb(d[e])}else e!=f&&(d[f]=d[e]),f++;d.length=f;d.Ka=!1;f==0&&(fb(d),delete R[a][c][b],R[a][c].f--,R[a][c].f==0&&(eb(R[a][c]),delete R[a][c],R[a].f--),R[a].f==0&&(eb(R[a]),delete R[a]))}}
function ob(a,c,b,d,e){var f=1,c=c[t]||(c[t]=++da);if(a[c]){a.F--;a=a[c];a.V?a.V++:a.V=1;try{for(var g=a.length,h=0;h<g;h++){var j=a[h];j&&!j.G&&(f&=pb(j,e)!==!1)}}finally{a.V--,nb(b,d,c,a)}}return Boolean(f)}
function pb(a,c){var b=a.handleEvent(c);if(a.wa){var d=a.key;if(Q[d]){var e=Q[d];if(!e.G){var f=e.src,g=e.type,h=e.La,j=e.capture;f.removeEventListener?(f==p||!f.$a)&&f.removeEventListener(g,h,j):f.detachEvent&&f.detachEvent(g in T?T[g]:T[g]="on"+g,h);f=f[t]||(f[t]=++da);h=R[g][j][f];if(S[f]){var l=S[f],A=z(l,e);A>=0&&y.splice.call(l,A,1);l.length==0&&delete S[f]}e.G=!0;h.Ka=!0;nb(g,j,f,h);delete Q[d]}}}return b}
hb(function(a,c){if(!Q[a])return!0;var b=Q[a],d=b.type,e=R;if(!(d in e))return!0;var e=e[d],f,g;Xa===k&&(Xa=C&&!p.addEventListener);if(Xa){var h;if(!(h=c))a:{h="window.event".split(".");for(var j=p;f=h.shift();)if(j[f]!=n)j=j[f];else{h=n;break a}h=j}f=h;h=!0 in e;j=!1 in e;if(h){if(f.keyCode<0||f.returnValue!=k)return!0;a:{var l=!1;if(f.keyCode==0)try{f.keyCode=-1;break a}catch(A){l=!0}if(l||f.returnValue==k)f.returnValue=!0}}l=lb();l.w(f,this);f=!0;try{if(h){for(var m=P(),w=l.currentTarget;w;w=w.parentNode)m.push(w);
g=e[!0];g.F=g.f;for(var u=m.length-1;!l.ja&&u>=0&&g.F;u--)l.currentTarget=m[u],f&=ob(g,m[u],d,!0,l);if(j){g=e[!1];g.F=g.f;for(u=0;!l.ja&&u<m.length&&g.F;u++)l.currentTarget=m[u],f&=ob(g,m[u],d,!1,l)}}else f=pb(b,l)}finally{if(m)m.length=0,fb(m);l.T();mb(l)}return f}d=new M(c,this);try{f=pb(b,d)}finally{d.T()}return f});new N(0,100);var V="StopIteration"in p?p.StopIteration:Error("StopIteration");function W(){}W.prototype.next=function(){i(V)};W.prototype.X=function(){return this};function qb(a){if(a instanceof W)return a;if(typeof a.X=="function")return a.X(!1);if(aa(a)){var c=0,b=new W;b.next=function(){for(;;)if(c>=a.length&&i(V),c in a)return a[c++];else c++};return b}i(Error("Not implemented"))}
function rb(a,c){if(aa(a))try{qa(a,c,k)}catch(b){b!==V&&i(b)}else{a=qb(a);try{for(;;)c.call(k,a.next(),k,a)}catch(d){d!==V&&i(d)}}};function sb(a,c){this.q={};this.d=[];var b=arguments.length;if(b>1){b%2&&i(Error("Uneven number of arguments"));for(var d=0;d<b;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){var e;if(a instanceof sb){d=tb(a);ub(a);e=[];for(b=0;b<a.d.length;b++)e.push(a.q[a.d[b]])}else{var b=[],f=0;for(d in a)b[f++]=d;d=b;b=[];f=0;for(e in a)b[f++]=a[e];e=b}for(b=0;b<d.length;b++)this.set(d[b],e[b])}}o=sb.prototype;o.f=0;o.W=0;function tb(a){ub(a);return a.d.concat()}
o.clear=function(){this.q={};this.W=this.f=this.d.length=0};function ub(a){if(a.f!=a.d.length){for(var c=0,b=0;c<a.d.length;){var d=a.d[c];Object.prototype.hasOwnProperty.call(a.q,d)&&(a.d[b++]=d);c++}a.d.length=b}if(a.f!=a.d.length){for(var e={},b=c=0;c<a.d.length;)d=a.d[c],Object.prototype.hasOwnProperty.call(e,d)||(a.d[b++]=d,e[d]=1),c++;a.d.length=b}}o.get=function(a,c){return Object.prototype.hasOwnProperty.call(this.q,a)?this.q[a]:c};
o.set=function(a,c){Object.prototype.hasOwnProperty.call(this.q,a)||(this.f++,this.d.push(a),this.W++);this.q[a]=c};o.X=function(a){ub(this);var c=0,b=this.d,d=this.q,e=this.W,f=this,g=new W;g.next=function(){for(;;){e!=f.W&&i(Error("The map has changed since the iterator was created"));c>=b.length&&i(V);var g=b[c++];return a?g:d[g]}};return g};function vb(){this.N=[];this.ia=new sb;this.Ta=this.Ua=this.Va=this.Oa=0;this.Q=new sb;this.xa=this.Sa=0;this.hb=1;this.ca=new N(0,4E3);this.ca.L=function(){return new wb};this.Pa=new N(0,50);this.Pa.L=function(){return new xb};var a=this;this.ga=new N(0,2E3);this.ga.L=function(){return String(a.hb++)};this.ga.ba=function(){};this.ab=3}function xb(){this.qa=this.Ra=this.count=0}
xb.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(this.Ra*10)/10," ms)");this.qa&&a.push(" [VarAlloc = ",this.qa,"]");return a.join("")};function wb(){}function yb(a,c,b,d){var e=[];b==-1?e.push("    "):e.push(zb(a.Da-b));e.push(" ",Ab(a.Da-c));a.da==0?e.push(" Start        "):a.da==1?(e.push(" Done "),e.push(zb(a.pb-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);a.lb>0&&e.push("[VarAlloc ",a.lb,"] ");return e.join("")}
wb.prototype.toString=function(){return this.type==n?this.Za:"["+this.type+"] "+this.Za};vb.prototype.reset=function(a){this.ab=a;for(a=0;a<this.N.length;a++){var c=this.ca.id;c&&O(this.ga,c);O(this.ca,this.N[a])}this.N.length=0;this.ia.clear();this.Oa=ea();this.xa=this.Sa=this.Ta=this.Ua=this.Va=0;c=tb(this.Q);for(a=0;a<c.length;a++){var b=this.Q.get(c[a]);b.count=0;b.Ra=0;b.qa=0;O(this.Pa,b)}this.Q.clear()};
vb.prototype.toString=function(){for(var a=[],c=-1,b=[],d=0;d<this.N.length;d++){var e=this.N[d];e.da==1&&b.pop();a.push(" ",yb(e,this.Oa,c,b.join("")));c=e.Da;a.push("\n");e.da==0&&b.push("|  ")}if(this.ia.f!=0){var f=ea();a.push(" Unstopped timers:\n");rb(this.ia,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",Ab(b.startTime),")\n")})}c=tb(this.Q);for(d=0;d<c.length;d++)b=this.Q.get(c[d]),b.count>1&&a.push(" TOTAL ",b,"\n");a.push("Total tracers created ",this.Sa,"\n","Total comments created ",
this.xa,"\n","Overhead start: ",this.Va," ms\n","Overhead end: ",this.Ua," ms\n","Overhead comment: ",this.Ta," ms\n");return a.join("")};function zb(a){var a=Math.round(a),c="";a<1E3&&(c=" ");a<100&&(c="  ");a<10&&(c="   ");return c+a}function Ab(a){a=Math.round(a);return String(100+a/1E3%60).substring(1,3)+"."+String(1E3+a%1E3).substring(1,4)}new vb;var Y={brush:{title:"Brush",mode:"source-over",cursor:"crosshair",size:2,h:{z:function(a,c,b){if(c.button===0)b.fillStyle="rgba("+a.m.join(",")+","+a.fa().pressure+")",b.lineWidth=a.D(),b.beginPath(),b.arc(c.x,c.y,b.lineWidth/2,0,Math.PI*2,!1),b.closePath(),b.fill(),a.M=c},A:function(a,c,b){var d=a.M;if(X&&c.button===0&&d)b.strokeStyle="rgba("+a.m.join(",")+","+a.fa().pressure+")",b.beginPath(),b.moveTo(d.x,d.y),b.lineTo(c.x,c.y),b.closePath(),b.stroke(),a.M=c}}},line:{title:"Line",mode:"source-over",
cursor:"crosshair",size:n,h:{z:function(a,c){if(c.button===0){var b=Y[a.b];b.o=!0;b.r=c}},A:function(a,c){if(X&&c.button===0){var b=Y[a.b].r,d=a.n.c;a.n.canvas.reset();d.strokeStyle="rgb("+a.m.join(",")+")";d.beginPath();d.moveTo(b.x,b.y);d.lineTo(c.x,c.y);d.closePath();d.stroke()}},P:function(a,c,b){var d=Y[a.b];if(d.o)d.o=!1,d=d.r,a.n.canvas.reset(),b.strokeStyle="rgb("+a.m.join(",")+")",b.lineWidth=a.D(),b.beginPath(),b.moveTo(d.x,d.y),b.lineTo(c.x,c.y),b.closePath(),b.stroke()}}},rectangle:{title:"Rectangle",
mode:"source-over",lineCap:"butt",lineJoin:"miter",cursor:"crosshair",size:n,filled:!0,h:{z:function(a,c){if(c.button===0){var b=Y[a.b];b.o=!0;b.r=c}},A:function(a,c){if(X&&c.button===0){var b=Y[a.b].r,d=c.altKey,e=a.n.canvas,f=a.n.c,g=c.y-b.y,h=c.x-b.x;c.shiftKey&&(h=h>0?Math.abs(g):-Math.abs(g));e.reset();f.strokeStyle="rgb("+a.m.join(",")+")";f.beginPath();f.rect(!d?b.x:b.x-h,!d?b.y:b.y-g,!d?h:2*h,!d?g:2*g);f.closePath();f.stroke()}},P:function(a,c,b){var d=Y[a.b];if(d.o){d.o=!1;var d=d.r,e=c.altKey,
f=a.n.canvas,g=c.y-d.y,h=c.x-d.x,j=a.D();c.shiftKey&&(h=h>0?Math.abs(g):-Math.abs(g));f.reset();b.strokeStyle="rgb("+a.m.join(",")+")";b.lineWidth=j;b.beginPath();b.rect((!e?d.x:d.x-h)+(h>0?j/2:-j/2),(!e?d.y:d.y-g)+(g>0?j/2:-j/2),(!e?h:2*h)-(h>0?j:-j),(!e?g:2*g)-(g>0?j:-j));b.closePath();b.stroke()}}}},ellipse:{title:"Ellipse",mode:"source-over",cursor:"crosshair",size:n,filled:!0,h:{z:function(a,c){if(c.button===0){var b=Y[a.b];b.o=!0;b.r=c}},A:function(a,c){if(X&&c.button===0){var b=Y[a.b].r,d=
c.altKey,e=a.n.canvas,f=a.n.c,g=c.y-b.y,h=c.x-b.x;c.shiftKey&&(h=h>0?Math.abs(g):-Math.abs(g));e.reset();f.strokeStyle="rgb("+a.m.join(",")+")";f.beginPath();f.Ca(!d?b.x:b.x-h,!d?b.y:b.y-g,!d?h:2*h,!d?g:2*g);f.closePath();f.stroke()}},P:function(a,c,b){var d=Y[a.b];if(d.o){d.o=!1;var d=d.r,e=c.altKey,f=a.n.canvas,g=c.y-d.y,h=c.x-d.x;c.shiftKey&&(h=h>0?Math.abs(g):-Math.abs(g));f.reset();b.strokeStyle="rgb("+a.m.join(",")+")";b.lineWidth=a.D();b.beginPath();b.Ca(!e?d.x:d.x-h,!e?d.y:d.y-g,!e?h:2*h,
!e?g:2*g);b.closePath();b.stroke()}}}},eraser:{title:"Eraser",mode:"destination-out",cursor:"crosshair",size:20,fb:!1,h:{focus:function(){},z:function(a,c,b){if(c.button===0)b.lineWidth=a.D(),b.beginPath(),b.arc(c.x,c.y,b.lineWidth/2,0,Math.PI*2,!1),b.closePath(),b.fill(),a.Ha=c},A:function(a,c,b){if(X&&c.button===0){var d=a.Ha;b.beginPath();b.moveTo(d.x,d.y);b.lineTo(c.x,c.y);b.closePath();b.stroke();a.Ha=c}}}},marquee:{title:"Selection",mode:"source-over",cursor:"crosshair",size:!1,l:0,h:{w:function(a){var c;
c=H("canvas",{width:a.a.clientWidth,height:a.a.clientHeight,transparent:"true","class":"selections"});a.a.appendChild(c);a.H={canvas:c,c:c.getContext("2d")};c=H("canvas",{width:a.a.clientWidth,height:a.a.clientHeight,transparent:"true","class":"selection-content"});a.a.appendChild(c);a.B={canvas:c,c:c.getContext("2d")}},blur:function(a,c){var b=Y[a.b],d=a.B.canvas,e=a.H.canvas;if(b.R){var f=d.toDataURL(),g=new Image;g.onload=function(){c.globalCompositeOperation=b.mode;c.drawImage(a,0,0)};g.src=f;
b.l=0;b.R=!1}d.reset();e.reset();b.e=k},z:function(a,c,b){var d=Y[a.b];if(d.l==2){var e=a.B.canvas,f=a.B.c,a=a.H.canvas,g=d.e;if(Bb(c.x,c.y,g)){if(!d.R)d.Y=b.getImageData.apply(b,g),d.nb=[c.x-g[0]+0.5,c.y-g[1]+0.5],f.putImageData(d.Y,g[0],g[1]),b.globalCompositeOperation="destination-out",b.beginPath(),b.rect.apply(b,g),b.closePath(),b.fill();d.l=3;d.K=c;d.J=c;return}else f=e.toDataURL(),e.reset(),a.reset(),e=new Image,e.onload=function(){b.globalCompositeOperation=d.mode;b.drawImage(this,0,0)},e.src=
f,d.l=0,d.R=!1}d.l=1;d.K=c;d.e=[c.x+0.5,c.y+0.5,0,0]},A:function(a,c){var b=Y[a.b],d;switch(b.l){case 1:d=[c.x-b.K.x,c.y-b.K.y];b.e[2]=d[0];b.e[3]=d[1];break;case 3:d=[c.x-b.J.x,c.y-b.J.y];b.e[0]+=d[0];b.e[1]+=d[1];var e=a.B.canvas,f=a.B.c;d=b.e;e.reset();f.putImageData(b.Y,d[0],d[1]);b.J=c}e=a.H.canvas;f=a.H.c;d=b.e;e.reset();f.beginPath();f.rect.apply(f,d);f.closePath();f.stroke()},P:function(a,c){var b=Y[a.b],d;switch(b.l){case 1:d=[c.x-b.K.x,c.y-b.K.y];if(d[0]===0||d[1]===0){b.e=k;break}b.e[2]=
d[0];b.e[3]=d[1];var e=a.H.canvas,f=a.H.c;d=b.e;e.reset();f.beginPath();f.rect.apply(f,d);f.closePath();f.stroke();b.l=2;break;case 3:d=[c.x-b.J.x,c.y-b.J.y],b.e[0]+=d[0],b.e[1]+=d[1],e=a.B.canvas,f=a.B.c,d=b.e,e.reset(),f.putImageData(b.Y,d[0],d[1]),b.l=2,b.R=!0}}}}};var Z={grid:{ta:!1,ra:function(a){a.O.canvas.style.display="block"},ya:function(a){a.O.canvas.style.display="none"}},"wacom-plugin":{ta:!0,ra:function(){Cb=!0},ya:function(){Cb=!1}}};function x(a,c){this.j={t:"#FFFFFF",gb:"rgba(0, 0, 0, 0.05)",Ea:20,bb:"#000000",aa:"brush"};this.kb="brush,eraser,line,rectangle,ellipse,marquee".split(",");this.jb=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF"];this.mb={pressure:1};this.S=a;c&&Object.keys(c).forEach(function(a){this.j[a]=c[a]},this)}o=x.prototype;
o.eb=function(a){var c=this.a.clientWidth,b=this.a.clientHeight,d=this.i,e=d.length,f=H("canvas",{width:c,height:b}),g=f.getContext("2d"),h=[],j=[],l=0;d.forEach(function(d,m){if(d.t)g.fillStyle=d.t,g.fillRect(0,0,c,b),h[m]={color:d.t};else{var w=d.canvas.toDataURL(),u=new Image;u.src=w;u.ob=m;u.onload=function(){j[m]=u;h[m]={data:w};for(var b;b=j[l+1];)g.drawImage(b,0,0),l+=1;l+1===e&&(h.unshift({data:f.toDataURL()}),a(h))}}})};
o.ua=function(a){var c=this.j.Ea,b=a[0],a=a[1],d=b%c,e=a%c;d<c/2?e<c/2?(b-=d,a-=e):(b-=d,a+=c-e):e<c/2?(b+=c-d,a-=e):(b+=c-d,a+=c-e);return[b,a]};
o.Ya=function(){this.S.innerHTML="";Db(this);this.a=H("div",{"class":"area"});this.S.appendChild(this.a);this.toolbar=H("div",{"class":"sidebar"});Va(this.S,this.toolbar);Eb(this);Fb(this);this.sidebar=H("div",{"class":"sidebar"});this.S.appendChild(this.sidebar);Gb(this);Hb(this);this.options={};this.ha=H("div",{"class":"options"});this.sidebar.appendChild(this.ha);var a=H("ul");this.ha.appendChild(a);var c=Ib(this);a.appendChild(c);this.i=[];Jb(this);a=H("canvas",{width:this.a.clientWidth,height:this.a.clientHeight,
transparent:"true","class":"grid"});Va(this.a,a);this.O={canvas:a,c:a.getContext("2d")};var a=this.O.c,c=this.j.Ea,b=this.O.canvas.width,d=this.O.canvas.height;a.lineWidth=2;a.strokeStyle=this.j.gb;a.beginPath();for(var e=0;0<=b?e<b:e>b;0<=b?e+=1:e-=1)e%c===0&&(a.moveTo(e,0),a.lineTo(e,d));for(e=0;0<=d?e<d:e>d;0<=d?e+=1:e-=1)e%c===0&&(a.moveTo(0,e),a.lineTo(b,e));a.closePath();a.stroke();a=H("canvas",{width:this.a.clientWidth,height:this.a.clientHeight,transparent:"true","class":"temp"});this.a.appendChild(a);
this.n={canvas:a,c:a.getContext("2d")};Kb(this);Lb(this);Mb(this);this.Z(this.j.bb);this.$(this.j.aa)};function Eb(a){a.pa=H("ul",{"class":"tools"});a.toolbar.appendChild(a.pa);U(a.pa,"click",function(a){a=a.target;a.tagName==="LI"&&this.$(J(a,"tool"))},!1,a);Nb(a)}function Fb(a){a.ma=H("ul",{"class":"toggles"});a.toolbar.appendChild(a.ma);U(a.ma,"click",function(a){a=a.target;a.tagName==="LI"&&this.toggle(J(a,"toggle"))},!1,a);Ob(a)}
function Gb(a){a.Qa=H("div",{"class":"swatches"});a.sidebar.appendChild(a.Qa);var c=H("ul");a.Qa.appendChild(c);for(var b=a.jb,d=0,e=b.length;d<e;++d){var f=H("li");f.style.backgroundColor=b[d];I(f,"color",b[d]);c.appendChild(f)}U(c,"click",function(a){a=a.target;a.tagName==="LI"&&this.Z(J(a,"color"))},!1,a)}
function Hb(a){a.k=H("div",{"class":"layers"});a.sidebar.appendChild(a.k);var c=H("ul");a.k.appendChild(c);U(c,"click",function(a){a=a.target;if(a.nodeType===3)a=a.parentNode;switch(a.tagName){case "LI":this.s(J(a,"index"));break;case "SPAN":z(Na(a),"lock")>=0?(a=J(a.parentNode,"index"),this.i[a].p?this.Wa(a):this.Ia(a)):z(Na(a),"title")>=0&&this.s(J(a.parentNode,"index"))}},!1,a);Pb(a)}
function Pb(a){var c=H("ul",{"class":"toolbar"});a.k.appendChild(c);var b=H("li",{"class":"create"});b.setAttribute("title","New layer");U(b,"click",function(){Kb(this)},!1,a);c.appendChild(b);b=H("li",{"class":"delete"});b.setAttribute("title","Delete layer");U(b,"click",function(){this.za()},!1,a);c.appendChild(b)}
function Ib(a){var c=H("li",{"class":"size"}),b=H("input",{type:"range",min:2,max:50,value:1});c.appendChild(b);Object.defineProperty(a.options,"size",{get:function(){return b.value}});U(b,"change",function(){this.Na(b.value)},!1,a);return c}function Nb(a){a.oa={};var c=Y||{};a.kb.forEach(function(a){var d=c[a],e=H("li",{title:d.title});I(e,"tool",a);this.pa.appendChild(e);this.oa[a]=e;d.h&&typeof d.h.w==="function"&&d.h.w.call(d,this,e,n)},a)}
function Ob(a){a.na={};a.la={};Object.keys(Z||{}).forEach(function(a){var b=H("li",{title:Z[a].title});I(b,"toggle",a);this.ma.appendChild(b);this.la[a]=b},a)}function Lb(a){Object.keys(Z||{}).forEach(function(a){this.toggle(a,Z[a].ta)},a)}
function Jb(a){a.a.style.backgroundColor=a.j.t;var c={t:a.j.t};c.index=-1+a.i.push(c);a.va=c;var b=Qb(a);I(b,"index",c.index);F(b,"background");b.querySelector(".title").innerHTML="Background layer";U(b,"mouseover",function(){a.cb&&!a.va.p&&F(this,"swatch-change")});U(b,"mouseout",function(){a.cb&&!a.va.p&&G(this,"swatch-change")});c=H("span",{"class":"swatch"});c.style.backgroundColor=a.j.t;b.appendChild(c)}
function Kb(a){var c=H("canvas",{width:a.a.clientWidth,height:a.a.clientHeight,transparent:"true"}),b=a.a.querySelector(".selection-content");b?b.parentNode&&b.parentNode.insertBefore(c,b):a.a.appendChild(c);c={canvas:c,c:c.getContext("2d")};c.index=-1+a.i.push(c);b=Qb(a);b.querySelector(".title").innerHTML="New layer";I(b,"index",c.index);a.s(c.index)}
function Qb(a){var c=H("li");Va(a.k.querySelector("ul"),c);a=H("span",{"class":"title"});c.appendChild(a);a=H("span",{"class":"lock"});c.appendChild(a);return c}
function Mb(a){U(a.a,"mousedown",function(c){c.preventDefault();X=!0;if(this.g.p||a.g.canvas===k)return this.a.style.cursor="not-allowed",!1;Rb=!0;var c=Sb(this,c),b=Y[this.b];typeof a.I.z==="function"&&this.I.z.call(b,this,c,this.g.c);this.M=c;return!1},!1,a);U(a.a,"mouseup",function(a){if(X){X=!1;var b=Y[this.b];if(this.g.p)this.a.style.cursor=b.cursor||"default";a=Sb(this,a);typeof this.I.P==="function"&&this.I.P.call(b,this,a,this.g.c);this.M=a}},!1,a);U(window,"mousemove",function(a){if(X&&!this.g.p)Rb&&
a.preventDefault(),a=Sb(this,a),typeof this.I.A==="function"&&this.I.A.call(this.b,this,a,this.g.c),this.M=a},!1,a)}
function Sb(a,c){var b,d=b=0,e=a.a,f=n;do f=window.getComputedStyle(e,n),b+=e.offsetLeft-e.scrollLeft+parseInt(f.borderLeftWidth,10),d+=e.offsetTop-e.scrollTop+parseInt(f.borderTopWidth,10);while(e=e.offsetParent);b=[b,d];b=[c.clientX+window.scrollX-b[0],c.clientY+window.scrollY-b[1]];d=Y[a.b];a.na.grid&&d.fb!==!1&&(b=a.ua(b));return{x:b[0],y:b[1],button:c.button,ctrlKey:c.ctrlKey,altKey:c.altKey,shiftKey:c.shiftKey}}
o.s=function(a){var c=this.i[a];c||i(Error("Undefined layer"));if(this.g){var b=this.k.querySelector('li[data-index="'+this.g.index+'"]');b!==n&&G(b,"active")}this.g=c;F(this.k.querySelector('li[data-index="'+a+'"]'),"active");Tb(this)};o.sa=function(a){for(var c=this.i.length-1,b;b===k&&++a<=c;)b=this.i[a];if(b!==k)this.s(a);else{for(;b===k&&--a>=0;)b=this.i[a];b!==k&&this.s(a)}};
function Tb(a){var c=a.g;if(a.b&&c&&c.canvas)a=Y[a.b],c=c.c,c.globalCompositeOperation=a.mode||"source-over",c.lineWidth=a.size||1,c.lineCap=a.lineCap||"round"}o.Ia=function(a){var c=this.i[a];c||i(Error("Undefined layer"));c.p=!0;F(this.k.querySelector('li[data-index="'+a+'"]'),"locked")};o.Wa=function(a){var c=this.i[a];c||i(Error("Undefined layer"));c.p=!1;G(this.k.querySelector('li[data-index="'+a+'"]'),"locked")};
o.za=function(){var a=this.g;a||i(Error("Undefined layer"));a.p||(Wa(a.canvas),Wa(this.k.querySelector('li[data-index="'+a.index+'"]')),delete this.i[a.index],this.sa(a.index),this.g||this.s(Number(J(this.k.querySelector("li:last-child"),"index"))||0))};
o.$=function(a){var c=Y[a];c||i(Error('Undefined tool "'+a+'"'));var b=this.b;b&&(G(this.oa[b],"active"),b=Y[b],typeof b.h.blur==="function"&&b.h.blur.call(b,this,this.g.c));this.b=a;this.I=c.h||{};this.a.style.cursor=c.cursor||"default";F(this.oa[a],"active");typeof c.h.focus==="function"&&c.h.focus.call(c,this);a=Y[this.b].size;if(a===n)a=Y[this.j.aa].size;c=this.ha.querySelector(".size input");a===!1?c.disabled=!0:(c.disabled=!1,c.value=a);Tb(this)};
o.Z=function(a){if(Array.isArray(a))this.m=a;else if(typeof a==="string")a=a.charAt(0)==="#"?a.substring(1,7):a,this.m=[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),16)]};o.toggle=function(a,c){var b=Z[a];b||i(Error('Undefined toggle ("'+a+'")'));var d=typeof c!=="undefined"?Boolean(c):!this.na[a];(this.na[a]=d)?(b.ra.call(b,this),F(this.la[a],"active")):(b.ya.call(b,this),G(this.la[a],"active"))};
o.D=function(){var a=Y[this.b].size;return a===n?Y[this.j.aa].size:a};o.Na=function(a){var c=Y[this.b];if(c.size!==!1)c.size=Number(a)};o.fa=function(){var a=this.Xa;return!Cb||!a.isWacom||a.pointerType===0?this.mb:a};
function Db(a){var c=document.getElementById("wacom-plugin");a.Xa=c;if(!c)c=H("embed",{id:"wacom-plugin",type:"application/x-wacom-tablet",hidden:!0,pluginspage:"http://www.wacom.com/productsupport/plugin.php",style:"display: none"}),a.Xa=c,document.body.appendChild(c),U(window,"focus",function(){Wa(c);document.body.appendChild(c)})}var X=!1,Cb=!0,Rb;v("build",x.prototype.Ya);v("getState",x.prototype.eb);
function Bb(a,c,b){var d=!1;if(!b)return d;b[2]<0&&(b[0]+=b[2],b[2]=-b[2]);b[3]<0&&(b[1]+=b[3],b[3]=-b[3]);a>=b[0]-1&&a<=b[0]+b[2]&&c>=b[1]-1&&c<=b[1]+b[3]&&(d=!0);return d}HTMLCanvasElement.prototype.reset=function(){this.width=this.width};
CanvasRenderingContext2D.prototype.Ca=function(a,c,b,d){var e,f,g,h;g=b/2*0.5522848;h=d/2*0.5522848;e=a+b;f=c+d;b=a+b/2;d=c+d/2;this.moveTo(a,d);this.bezierCurveTo(a,d-h,b-g,c,b,c);this.bezierCurveTo(b+g,c,e,d-h,e,d);this.bezierCurveTo(e,d+h,b+g,f,b,f);this.bezierCurveTo(b-g,f,a,d+h,a,d)};var Ub=x,Vb="awesomeCanvas.Editor".split("."),$=p;!(Vb[0]in $)&&$.execScript&&$.execScript("var "+Vb[0]);for(var Wb;Vb.length&&(Wb=Vb.shift());)!Vb.length&&Ub!==k?$[Wb]=Ub:$=$[Wb]?$[Wb]:$[Wb]={};v("applyGridToCoords",x.prototype.ua);v("activateLayer",x.prototype.s);v("activateNearestLayer",x.prototype.sa);v("lockLayer",x.prototype.Ia);v("unlockLayer",x.prototype.Wa);v("deleteActiveLayer",x.prototype.za);v("activateTool",x.prototype.$);v("activateSwatch",x.prototype.Z);v("toggle",x.prototype.toggle);
v("getActiveToolSize",x.prototype.D);v("setActiveToolSize",x.prototype.Na);v("getWacomPlugin",x.prototype.fa);
